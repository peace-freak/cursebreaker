<script>
    async function fetchStats() {
        const sheetURL = "https://docs.google.com/spreadsheets/d/1sJNdgC2eCKXoeLrBqo3jdCFmKyzGVIMThOfI1S2sLgM/gviz/tq?tqx=out:json";

        try {
            let response = await fetch(sheetURL);
            let text = await response.text();
            
            // Extract JSON data from the response
            let jsonText = text.substring(text.indexOf("{"), text.lastIndexOf("}") + 1);
            let data = JSON.parse(jsonText);
            let rows = data.table.rows;

            // Debugging log (open console to check)
            console.log("✅ Raw JSON Data:", data);
            console.log("✅ Extracted Rows:", rows);

            // Safely extract values (checking if they exist)
            function getValue(rowIndex) {
                return rows[rowIndex]?.c[2]?.v ?? "N/A";
            }

            let rpgText = `
            ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
            ┃ CHARACTER: KACEMAN69       ┃
            ┃ TITLE: BLOODTHIRSTY WHELP  ┃
            ┃ LEVEL: ${getValue(0)}      ┃
            ┃ CLASS: ${getValue(1)}      ┃
            ┃ XP: ${getValue(2)} / ${getValue(3)} ┃
            ┃ NEXT CLASS: ${getValue(4)} ┃
            ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
            `;

            document.getElementById("rpgStats").innerText = rpgText;
        } catch (error) {
            document.getElementById("rpgStats").innerText = "⚠️ Error loading stats.";
            console.error("❌ Fetch error:", error);
        }
    }

    fetchStats();
    setInterval(fetchStats, 86400000);
</script>
